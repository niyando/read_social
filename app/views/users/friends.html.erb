<style>
  .container {
    display: flex;
    flex-flow: wrap;
    justify-content: center;
  }
  .item {
    margin: 5px;
    padding: 5px;
    text-align: center;
    min-width: 150px;
  }
  .item > img{
    margin-bottom: 5px;
    border-radius: 25%;
  }
</style>

<div class="container">
  <% @friends.each do |f| %>
    <div class="item">
      <img src="<%=f[:small_image_url]%>" alt=""><br>
      <a href="/friends/<%=f[:id]%>"><%= f[:name] %></a>
    </div>
  <% end %>
</div>


<script>
  $(document).ready(function(){

    function htmlForFriend(f){
      var str = "<div class='item'><img src='"+f.small_image_url+"'><br><a href='/friends/"+f.id+"'>"+f.name+"</a></div>";
      return str;
    }

    function renderMoreFriends(page){
      $.get('/more-friends?page='+page).then(function(res){
        var str = "";
        res.forEach(function(friend){
          str += htmlForFriend(friend);
        });
        $('div.container').append(str);
      });
    }

    <% 2.upto(@pages.to_i) do |p| %>
      renderMoreFriends(<%= p %>);
    <% end %>

  });
</script>